# Thermostat_2019A代码功能解读
# 1. 程序执行流程
应用程序入口是`simple-main.c`文件下的`int MAIN(MAIN_FUNCTION_PARAMETERS)`函数，该函数下只有三句代码，主要是初始化硬件和串口，执行最后的` emberAfMain(MAIN_FUNCTION_ARGUMENTS)`进入主程序。程序来到了`Thermostat_2019A_callbacks.c`文件下的`emberAfMainInitCallback()`函数，在该函数下：
- `appEventInit()`方法是风机、电表和阀门的初始化。
- `emberAfFanControlClusterServerAttributeChangedCallback(THERMOSTAT_EP, ZCL_FAN_CONTROL_FAN_MODE_ATTRIBUTE_ID)`和`emberAfThermostatClusterServerAttributeChangedCallback(THERMOSTAT_EP, ZCL_SYSTEM_MODE_ATTRIBUTE_ID)`是在接收到指令时会执行的回调函数。
- `emberEventControlSetDelayMS(displayBoardEventControl, 3000)`和`emberEventControlSetDelayMS(electricMeterEventControl, 3000)`是延时3秒后执行事件`displayBoardEventControl`和`electricMeterEventControl`。
# 2. 事件
应用程序一共自定义了6个自定义事件，每个事件都会对应有一个事件处理函数，它们分别是：
- `autoModeEventFunction()`自动模式事件的处理函数，指定空调的工作模式。
- `coolingModeEventFunction`制冷模式事件的处理函数，指定空调的工作模式。
- `heatingModeEventFunction()`制热模式事件的处理函数，但是程序没有做处理。
- `displayBoardEventFunction()`查询显示板数据事件的处理函数，主要查询的是温度数据。
- `electricMeterEventFunction()`电表轮询事件的处理函数，用于查询周期频率、电压、电流、功率和电能的数据。
- `networkEventFunction()`网络事件的处理函数，用于加入和离开网络。

事件需要用`emberEventControlSetActive(control)`函数来激活，也可以用`emberEventControlSetDelayMS(control, delay)`函数来延时激活，激活后可以用`emberEventControlSetInactive(control)`函数来停止事件。如果激活事件后没有停止事件，也没有设置下次执行的时间，事件会以最快的周期执行。
# 3. 具体功能
